<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cadastro de Novo Produto</title>
  <style>
    :root{
      --bg:#ffffff;
      --panel:#f9fafb;
      --muted:#f3f4f6;
      --text:#111827;
      --text-dim:#374151;
      --brand:#e30613;
      --accent:#e63946;
      --danger:#dc2626;
      --border:#d1d5db;
      --focus:#ef4444;
    }
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Arial,sans-serif;
      background:var(--bg); color:var(--text);
    }
    .container{
      max-width:1100px; margin:32px auto; padding:24px; background:var(--panel);
      border:1px solid var(--border); border-radius:18px;
    }
    header{ display:flex; align-items:center; gap:16px; margin-bottom:20px; }
    header img{height:60px}
    h1{margin:0; font-size:24px; color:var(--brand)}
    .sub{margin:0 0 20px; color:var(--text-dim); font-size:14px}
    .toolbar{display:flex; flex-wrap:wrap; gap:10px; margin:18px 0 14px;}
    .btn{appearance:none; border:1px solid var(--border); background:var(--muted); color:var(--text);
      padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600; font-size:14px; transition:.2s;}
    .btn:hover{transform: translateY(-1px); border-color:var(--brand)}
    .btn.primary{background:var(--brand); color:#fff; border:none}
    .btn.destructive{background:var(--danger); border:none; color:#fff}

    .form-header{
      display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:24px;
    }
    .form-header .full{ grid-column:1 / -1; }
    label{ font-size:13px; color:var(--text-dim); margin-bottom:4px; display:block }
    input{
      width:100%; box-sizing:border-box; padding:10px 12px; border-radius:10px;
      border:1px solid var(--border); background:#fff; color:var(--text); font-size:14px;
      outline:none;
    }
    input:focus{ border-color:var(--focus); box-shadow:0 0 0 2px rgba(239,68,68,.3); }

    table{width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:14px;}
    thead th{position:sticky; top:0; z-index:1; background:var(--muted);
      border-bottom:1px solid var(--border); padding:12px 10px; text-align:left; font-size:13px; color:var(--text-dim);}
    tbody td{border-bottom:1px dashed var(--border); padding:12px 10px; vertical-align:top}
    tbody tr:hover{background:#fef2f2}
    select,input[type="number"],textarea{
      width:100%; box-sizing:border-box; padding:8px 10px; border-radius:10px; border:1px solid var(--border);
      background:#fff; color:var(--text); outline:none; font-size:14px;
    }
    select:focus,input:focus,textarea:focus{border-color:var(--focus); box-shadow:0 0 0 2px rgba(239,68,68,.3)}
    .obs-field{margin-top:8px}
    .note{margin-top:14px; color:var(--text-dim); font-size:12px}
    @media (max-width: 780px){
      .form-header{ grid-template-columns:1fr }
      table, thead, tbody, th, td, tr{display:block}
      thead{display:none}
      tbody tr{border:1px solid var(--border); border-radius:12px; padding:10px; margin-bottom:12px}
      tbody td{border:none; padding:6px 0}
      tbody td::before{content:attr(data-label); display:block; color:var(--text-dim); font-size:12px; margin-bottom:4px}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="https://drive.google.com/uc?export=view&id=1_gDN-U9NOkaudQcbSMGScUTibvsAdPPY" alt="WAY Gestão de Serviços">
      <h1>Cadastro de Novo Produto</h1>
    </header>
    <p class="sub">Preencha os dados do cliente/produto e, abaixo, as regras de cada serviço.</p>

    <div class="form-header">
      <div><label for="nome">Nome</label><input type="text" id="nome" placeholder="Digite o nome"></div>
      <div><label for="email">E-mail</label><input type="email" id="email" placeholder="exemplo@dominio.com"></div>
      <div><label for="empresa">Empresa</label><input type="text" id="empresa" placeholder="Razão social"></div>
      <div><label for="cnpj">CNPJ</label><input type="text" id="cnpj" placeholder="00.000.000/0001-00"></div>
      <div class="full"><label for="produto">Nome do Produto</label><input type="text" id="produto" placeholder="Produto contratado"></div>
    </div>

    <div class="toolbar">
      <button class="btn" id="exportCsv">Exportar CSV</button>
      <button class="btn" id="printPage">Imprimir</button>
      <button class="btn" id="downloadEml">Baixar E-mail (.eml)</button>
      <button class="btn destructive" id="clearAll">Limpar</button>
    </div>

    <table id="servicesTable">
      <thead>
        <tr>
          <th>Serviço</th>
          <th>Disponível</th>
          <th>Limite por mês</th>
          <th>Limite por ano</th>
          <th>Limite por Km</th>
          <th>Limite por valor (R$)</th>
          <th>Observação</th>
        </tr>
      </thead>
      <tbody>
      <tr>
        <td>Reboque Pane Eletromecânica</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Reboque Colisão</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Reboque de Continuação de atendimento.</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Pane Seca</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Troca de Pneu</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Carga de Bateria</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Chaveiro</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Meio de Transporte a Domicílio</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Taxi / APP</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Hospedagem</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Linha Branca</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
      <tr>
        <td>Motorista Amigo</td>
        <td><select><option></option><option>Sim</option><option>Não</option></select></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" /></td>
        <td><input type="number" min="0" step="0.01" /></td>
        <td><textarea rows="2"></textarea></td>
      </tr>
    
</tbody>
    </table>

    <p class="note">Dica: ao marcar "Não" em Disponível, os campos de limites e observação ficam desativados.</p>
  </div>

<script>
(function(){
  const services = [
    "Reboque Pane Eletromecânica",
    "Reboque Colisão",
    "Reboque de Continuação de atendimento.",
    "Pane Seca",
    "Troca de Pneu",
    "Carga de Bateria",
    "Chaveiro",
    "Meio de Transporte a Domicílio",
    "Taxi / APP",
    "Hospedagem",
    "Linha Branca",
    "Motorista Amigo"
  ];
  const tbody = document.querySelector('#servicesTable tbody');

  function createSelect(){
    const sel = document.createElement('select');
    ["","Sim","Não"].forEach(v=>{
      const o=document.createElement('option'); o.value=v;o.textContent=v||"Selecionar"; sel.appendChild(o);
    });
    sel.addEventListener('change',handleAvailabilityChange);
    return sel;
  }
  function createInput(type,ph){ const i=document.createElement('input'); i.type=type; i.placeholder=ph; return i; }
  function createObs(){ const t=document.createElement('textarea'); t.className='obs-field'; t.placeholder="Observação"; t.rows=2; return t; }
  function handleAvailabilityChange(e){
    const row=e.target.closest('tr'); const disabled=e.target.value==="Não";
    row.querySelectorAll('input,textarea').forEach(inp=>{inp.disabled=disabled;if(disabled) inp.value='';});
  }
  function addRow(name){
    const tr=document.createElement('tr');
    tr.innerHTML=`<td data-label="Serviço">${name}</td>`;
    const tdSel=document.createElement('td'); tdSel.setAttribute('data-label','Disponível'); tdSel.appendChild(createSelect());
    const tdMes=document.createElement('td'); tdMes.appendChild(createInput('number','mês'));
    const tdAno=document.createElement('td'); tdAno.appendChild(createInput('number','ano'));
    const tdKm=document.createElement('td'); tdKm.appendChild(createInput('number','km'));
    const tdVal=document.createElement('td'); tdVal.appendChild(createInput('number','valor'));
    const tdObs=document.createElement('td'); tdObs.appendChild(createObs());
    tr.append(tdSel,tdMes,tdAno,tdKm,tdVal,tdObs);
    tbody.appendChild(tr);
  }
  

  // CSV export
  document.getElementById("exportCsv").onclick = function(){
    const rows = [...document.querySelectorAll("#servicesTable tbody tr")];
    const header = ["Serviço","Disponível","Mês","Ano","Km","R$","Observação"];
    const data = rows.map(tr=>{
      const td=tr.querySelectorAll("td");
      return [
        td[0].textContent,
        td[1].querySelector("select").value,
        td[2].querySelector("input").value,
        td[3].querySelector("input").value,
        td[4].querySelector("input").value,
        td[5].querySelector("input").value,
        td[6].querySelector("textarea").value.replace(/\n/g," ")
      ];
    });
    const csv = [header, ...data].map(row => row.map(v=>`"${v}"`).join(";")).join("\r\n");
    const blob = new Blob(["\uFEFF"+csv], {{type:"text/csv"}});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "cadastro_produto.csv";
    a.click();
    URL.revokeObjectURL(a.href);
  };

  document.getElementById("printPage").onclick = function(){ window.print(); };

  document.getElementById("clearAll").onclick = function(){
    if (confirm("Deseja limpar tudo?")) location.reload();
  };

  document.getElementById("downloadEml").onclick = function(){
    const h = id => document.getElementById(id).value;
    const html = `
      <h2>Cadastro de Novo Produto</h2>
      <p><strong>Nome:</strong> ${h("nome")}<br>
      <strong>E-mail:</strong> ${h("email")}<br>
      <strong>Empresa:</strong> ${h("empresa")}<br>
      <strong>CNPJ:</strong> ${h("cnpj")}<br>
      <strong>Produto:</strong> ${h("produto")}</p>
      ` + document.getElementById("servicesTable").outerHTML;
    const boundary = "----=_NextPart_000_001";
    const eml = `To: alexandreandrade@waygestoes.com.br, dandarasantana@waygestoes.com.br
Subject: Cadastro - ${h("empresa")||h("nome")}
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="${boundary}"

--${boundary}
Content-Type: text/plain; charset="UTF-8"

Cadastro de novo produto.

--${boundary}
Content-Type: text/html; charset="UTF-8"

${html}

--${boundary}--`;

    const blob = new Blob([eml], {{type:"message/rfc822"}});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "cadastro_produto.eml";
    a.click();
    URL.revokeObjectURL(a.href);
  };
})();
</script>
</body>
</html>
